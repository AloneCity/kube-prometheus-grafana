groups:
- name: rules
  rules:
  - alert: NodeCPUUsage
    expr: (sum (rate (container_cpu_usage_seconds_total{id="/",kubernetes_io_hostname=~".*"}[2m])) / sum (machine_cpu_cores{kubernetes_io_hostname=~".*"}) * 100) > 75
    for: 2m
    labels:
      severity: page
    annotations:
      DESCRIPTION: '{{$labels.instance}}: CPU usage is above 75% (current value is:
        {{ $value }})'
      SUMMARY: '{{$labels.instance}}: High CPU usage detected'
  - alert: NodeLowContainerDisk
    expr: (sum (container_fs_usage_bytes{device=~"^/dev/[sv]d[a-z][1-9]$",id="/",kubernetes_io_hostname=~".*"}) / sum (container_fs_limit_bytes{device=~"^/dev/[sv]d[a-z][1-9]$",id="/",kubernetes_io_hostname=~".*"}) * 100) > 75
    for: 2m
    labels:
      severity: page
    annotations:
      DESCRIPTION: '{{$labels.instance}}: Container host disk usage is above 75% (current value
        is: {{ $value }})'
      SUMMARY: '{{$labels.instance}}: Low host disk space'
  
  - alert: NodeMemoryUsage
    expr: (sum (container_memory_working_set_bytes{id="/",kubernetes_io_hostname=~".*"}) /  sum (machine_memory_bytes{kubernetes_io_hostname=~".*"}) * 100) > 75
    for: 2m
    labels:
      severity: page
    annotations:
      DESCRIPTION: '{{$labels.instance}}: Memory usage is above 75% (current value
        is: {{ $value }})'
      SUMMARY: '{{$labels.instance}}: High memory usage detected'